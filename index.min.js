/*!
 *
 * The MIT License (MIT)
 *
 * Copyright © 2024 Taufik Nurrohman <https://github.com/taufik-nurrohman>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the “Software”), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED “AS IS”, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).TextEditor=t()}(this,(function(){"use strict";var e=function(e,t){return-1!==t.indexOf(e)},t=function(e){return Array.isArray(e)},r=function(e){return"function"==typeof e},n=function(e,t){return e&&l(t)&&e instanceof t},o=function(e){return u(e)&&0==e%1},u=function(e){return"number"==typeof e},c=function(e,t){return void 0===t&&(t=!0),"object"==typeof e&&(!t||n(e,Object))},l=function(e){return function(e){return void 0!==e}(e)&&!function(e){return null===e}(e)},i=function(e){return"string"==typeof e},a=function(e){return e.length},f=function r(){for(var n=arguments.length,o=Array(n),u=0;u<n;u++)o[u]=arguments[u];for(var i=o.shift(),f=0,s=a(o);f<s;++f)for(var v in o[f])if(l(i[v]))if(t(i[v])&&t(o[f][v])){i[v]=[].concat(i[v]);for(var p=0,d=a(o[f][v]);p<d;++p)e(o[f][v][p],i[v])||i[v].push(o[f][v][p])}else c(i[v])&&c(o[f][v])?i[v]=r({},i[v],o[f][v]):i[v]=o[f][v];else i[v]=o[f][v];return i},s=document,v=window,p=s.body,d=s.documentElement,h=function(e,t){return void 0===t&&(t=""),e.replace(m("["+t+b.replace(/./g,"\\$&")+"]"),"\\$&")},m=function(e,t){return function(e){return n(e,RegExp)}(e)?e:RegExp(e,l(t)?t:"g")},b="!$^*()+=[]{}|:<>,.?/-";var g={blur:0,click:0,copy:0,cut:0,focus:0,input:0,keydown:"key.down",keyup:"key.up",mousedown:"mouse.down",mouseenter:"mouse.enter",mouseleave:"mouse.exit",mousemove:"mouse.move",mouseup:"mouse.up",paste:0,scroll:0,touchend:"mouse.up",touchmove:"mouse.move",touchstart:"mouse.down",wheel:"scroll"};function y(e,t){return(e||"")["trim"+(-1===t?"Left":1===t?"Right":"")]()}function $(e,u){var s=this;if(!e)return s;if(!n(s,$))return new $(e,u);var b=/^([\s\S]*?)$/,w=function(){return e.disabled},E=function(){return e.readOnly},x=function(){return e.value.replace(/\r/g,"")},S=x();return s.attach=function(){var n,T,k,L=function(e){var t={};return e.hooks=t,e.fire=function(r,n){return l(t[r])?(t[r].forEach((function(t){return t.apply(e,n)})),e):e},e.off=function(r,n){if(!l(r))return t={},e;if(l(t[r]))if(l(n)){var o=t[r].length;if(0===o)delete t[r];else for(var u=0;u<o;++u)if(n===t[r][u]){t[r].splice(u,1);break}}else delete t[r];return e},e.on=function(r,n){return l(t[r])||(t[r]=[]),l(n)&&t[r].push(n),e},e}(s),O=L.fire,j=function(e){var t=e.type,r=x();r!==S&&(S=r,O("change",[e])),O(g[t]||t,[e])};for(var A in s.$=function(){return new $.S(e.selectionStart,e.selectionEnd,x())},s.blur=function(){return e.blur(),s},s.detach=function(){for(var n in S=x(),g)o=n,l=j,e.removeEventListener(o,l);var o,l;if(t(u.with))for(var f=0,v=a(u.with);f<v;++f){var p=u.with[f];i(p)&&(p=$[p]),c(p)&&r(p.detach)&&p.detach.call(s,e,u)}for(var d in s)"attach"!==d&&delete s[d];return s},s.focus=function(t){var r,n;return-1===t?r=n=0:1===t&&(r=a(x()),n=e.scrollHeight),l(r)&&l(n)&&(e.selectionStart=e.selectionEnd=r,e.scrollTop=n),e.focus(),s},s.get=function(){return!w()&&x()||null},s.insert=function(e,t,r){var n=b;return r&&s.replace(n,""),-1===t?n=/$/:1===t&&(n=/^/),s.replace(n,e,t)},s.let=function(){return e.value=s.value,s},s.match=function(e,n){var o=s.$(),u=o.after,c=o.before,l=o.value;if(t(e)){var i=[c.match(e[0]),l.match(e[1]),u.match(e[2])];return r(n)?n.call(s,i[0]||[],i[1]||[],i[2]||[]):[!!i[0],!!i[1],!!i[2]]}var a=l.match(e);return r(n)?n.call(s,a||[]):!!a},s.peel=function(e,t,r){var n=s.$(),o=n.after,u=n.before,c=n.value;e=h(e),t=h(t);var l=m(e+"$",""),i=m("^"+t,"");return r?s.replace(m("^"+e+"([\\s\\S]*?)"+t+"$",""),"$1"):l.test(u)&&i.test(o)?(u=u.replace(l,""),o=o.replace(i,""),s.set(u+c+o).select(u=a(u),u+a(c))):s.select()},s.pull=function(e,t){void 0===t&&(t=!0);var r=s.$(),n=r.before,c=r.end,i=r.length,f=r.start,v=r.value;return o(e=l(e)?e:u.tab)&&(e=" ".repeat(e)),""!==n&&"\n"!==n.slice(-1)&&e!==n.slice(-a(e))&&s.select(f-=a(n.split("\n").pop()),i?c:f),e=h(e),i?t?s.replace(m("^"+e,"gm"),""):s.insert(v.split("\n").map((function(t){return m("^("+e+")*$","").test(t)?t:t.replace(m("^"+e,""),"")})).join("\n")):s.replace(m(e+"$",""),"",-1)},s.push=function(e,t){void 0===t&&(t=!1);var r=s.$(),n=r.before,c=r.end,i=r.length,f=r.start;return o(e=l(e)?e:u.tab)&&(e=" ".repeat(e)),""!==n&&"\n"!==n.slice(-1)&&e!==n.slice(-a(e))&&s.select(f-=a(n.split("\n").pop()),i?c:f),i?s.replace(m("^"+(t?"":"(?!$)"),"gm"),e):s.insert(e,-1)},s.replace=function(e,t,r){var n=s.$(),o=n.after,u=n.before,c=n.value;return-1===r?u=u.replace(e,t):1===r?o=o.replace(e,t):c=c.replace(e,t),s.set(u+c+o).select(u=a(u),u+a(c))},s.select=function(){if(w()||E())return e.focus(),s;for(var t=arguments.length,r=Array(t),n=0;n<t;n++)r[n]=arguments[n];var o,u,c,l,i=a(r),f=s.$(),h=f.start,m=f.end;if(o=v.pageXOffset||d.scrollLeft||p.scrollLeft,u=v.pageYOffset||d.scrollTop||p.scrollTop,c=e.scrollLeft,l=e.scrollTop,0===i)r[0]=h,r[1]=m;else if(1===i){if(!0===r[0])return e.focus(),e.select(),s;r[1]=r[0]}return e.focus(),e.selectionStart=r[0],e.selectionEnd=r[1],e.scrollLeft=c,e.scrollTop=l,v.scroll(o,u),s},s.self=s.source=e,s.set=function(t){return w()||E()||(e.value=t),s},s.state=u=f({},$.state,o(u)||i(u)?{tab:u}:u||{}),s.trim=function(e,t,r,n,o){void 0===o&&(o=!0),null!==e&&!1!==e&&(e=e||""),null!==t&&!1!==t&&(t=t||""),null!==r&&!1!==r&&(r=r||""),null!==n&&!1!==n&&(n=n||"");var u=s.$(),c=u.after,l=u.before,i=u.value,f=y(c,-1),v=y(l,1);return c=!1!==t?(f||!o?t:"")+y(c,-1):c,l=!1!==e?y(l,1)+(v||!o?e:""):l,!1!==n&&(i=y(i,1)),!1!==r&&(i=y(i,-1)),s.set(l+i+c).select(l=a(l),l+a(i))},s.value=x(),s.wrap=function(e,t,r){var n=s.$(),o=n.after,u=n.before,c=n.value;return r?s.replace(b,e+"$1"+t):s.set(u+e+c+t+o).select(u=a(u+e),u+a(c))},g)n=A,T=j,void 0===(k=void 0)&&(k=!1),e.addEventListener(n,T,k);if(t(u.with))for(var R=0,H=a(u.with);R<H;++R){var X=u.with[R];i(X)&&(X=$[X]),r(X)?X.call(s,e,u):c(X)&&r(X.attach)&&X.attach.call(s,e,u)}return s},s.attach()}return $.esc=h,$.state={tab:"\t",with:[]},$.S=function(e,t,r){var n=this,o=r.slice(e,t);n.after=r.slice(t),n.before=r.slice(0,e),n.end=t,n.length=a(o),n.start=e,n.value=o,n.toString=function(){return o}},$.version="4.0.2",$.x=b,$}));