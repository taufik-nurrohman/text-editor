/*!
 *
 * The MIT License (MIT)
 *
 * Copyright © 2024 Taufik Nurrohman <https://github.com/taufik-nurrohman>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the “Software”), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED “AS IS”, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).TextEditor=t()}(this,(function(){"use strict";var e=function(e,t){return-1!==t.indexOf(e)},t=function(e){return Array.isArray(e)},r=function(e){return"function"==typeof e},n=function(e,t){return e&&i(t)&&e instanceof t},o=function(e){return u(e)&&0==e%1},u=function(e){return"number"==typeof e},c=function(e,t){return void 0===t&&(t=!0),"object"==typeof e&&(!t||n(e,Object))},i=function(e){return function(e){return void 0!==e}(e)&&!function(e){return null===e}(e)},l=function(e){return"string"==typeof e},a=function(e){return e.length},f=function r(){for(var n=arguments.length,o=Array(n),u=0;u<n;u++)o[u]=arguments[u];for(var l=o.shift(),f=0,s=a(o);f<s;++f)for(var p in o[f])if(i(l[p]))if(t(l[p])&&t(o[f][p])){l[p]=[].concat(l[p]);for(var v=0,d=a(o[f][p]);v<d;++v)e(o[f][p][v],l[p])||l[p].push(o[f][p][v])}else c(l[p])&&c(o[f][p])?l[p]=r({},l[p],o[f][p]):l[p]=o[f][p];else l[p]=o[f][p];return l},s=document,p=window,v=s.body,d=s.documentElement,h=function(e,t){return void 0===t&&(t=""),e.replace(m("["+t+b.replace(/./g,"\\$&")+"]"),"\\$&")},m=function(e,t){return function(e){return n(e,RegExp)}(e)?e:RegExp(e,i(t)?t:"g")},b="!$^*()+=[]{}|:<>,.?/-";var g={blur:0,click:0,copy:0,cut:0,focus:0,input:0,keydown:"key.down",keyup:"key.up",mousedown:"mouse.down",mouseenter:"mouse.enter",mouseleave:"mouse.exit",mousemove:"mouse.move",mouseup:"mouse.up",paste:0,scroll:0,touchend:"mouse.up",touchmove:"mouse.move",touchstart:"mouse.down",wheel:"scroll"};function y(e,t){return(e||"")["trim"+(-1===t?"Left":1===t?"Right":"")]()}var $=1;function w(e,u){var s=this,b=s.constructor.prototype;if(!e)return s;if(!n(s,w))return new w(e,u);var E=/^([\s\S]*?)$/,x=function(){return e.disabled},S=function(){return e.readOnly},T=function(){return e.value.replace(/\r/g,"")},k=T();return b.attach=function(n){s.self=e,s.state=u=f({},w.state,o(u)||l(u)?{tab:u}:u||{}),s.value=T();var L,O,j,A=function(e){var t={},r=e.constructor.prototype;return e.hooks=t,r.fire=function(r,n){return i(t[r])?(t[r].forEach((function(t){return t.apply(e,n)})),e):e},r.off=function(r,n){if(!i(r))return t={},e;if(i(t[r]))if(i(n)){var o=t[r].length;if(0===o)delete t[r];else for(var u=0;u<o;++u)if(n===t[r][u]){t[r].splice(u,1);break}}else delete t[r];return e},r.on=function(r,n){return i(t[r])||(t[r]=[]),i(n)&&t[r].push(n),e},e}(s),R=A.fire,H=function(e){var t=e.type,r=T();r!==k&&(k=r,R("change",[e])),R(g[t]||t,[e])};if($=0,!n)return s;for(var X in b.$=function(){return new w.S(e.selectionStart,e.selectionEnd,T())},b.blur=function(){return e.blur(),s},b.detach=function(){for(var n in k=T(),g)o=n,i=H,e.removeEventListener(o,i);var o,i;if(t(u.with))for(var f=0,p=a(u.with);f<p;++f){var v=u.with[f];l(v)&&(v=w[v]),c(v)&&r(v.detach)&&v.detach.call(s,e,u)}for(var d in b)"attach"!==d&&delete b[d];return s},b.focus=function(t){var r,n;return-1===t?r=n=0:1===t&&(r=a(T()),n=e.scrollHeight),i(r)&&i(n)&&(e.selectionStart=e.selectionEnd=r,e.scrollTop=n),e.focus(),s},b.get=function(){return!x()&&T()||null},b.insert=function(e,t,r){var n=E;return r&&s.replace(n,""),-1===t?n=/$/:1===t&&(n=/^/),s.replace(n,e,t)},b.let=function(){return e.value=s.value,s},b.match=function(e,n){var o=s.$(),u=o.after,c=o.before,i=o.value;if(t(e)){var l=[c.match(e[0]),i.match(e[1]),u.match(e[2])];return r(n)?n.call(s,l[0]||[],l[1]||[],l[2]||[]):[!!l[0],!!l[1],!!l[2]]}var a=i.match(e);return r(n)?n.call(s,a||[]):!!a},b.peel=function(e,t,r){var n=s.$(),o=n.after,u=n.before,c=n.value;e=h(e),t=h(t);var i=m(e+"$",""),l=m("^"+t,"");return r?s.replace(m("^"+e+"([\\s\\S]*?)"+t+"$",""),"$1"):i.test(u)&&l.test(o)?(u=u.replace(i,""),o=o.replace(l,""),s.set(u+c+o).select(u=a(u),u+a(c))):s.select()},b.pull=function(e,t){void 0===t&&(t=!0);var r=s.$(),n=r.before,c=r.end,l=r.length,f=r.start,p=r.value;return o(e=i(e)?e:u.tab)&&(e=" ".repeat(e)),""!==n&&"\n"!==n.slice(-1)&&e!==n.slice(-a(e))&&s.select(f-=a(n.split("\n").pop()),l?c:f),e=h(e),l?t?s.replace(m("^"+e,"gm"),""):s.insert(p.split("\n").map((function(t){return m("^("+e+")*$","").test(t)?t:t.replace(m("^"+e,""),"")})).join("\n")):s.replace(m(e+"$",""),"",-1)},b.push=function(e,t){void 0===t&&(t=!1);var r=s.$(),n=r.before,c=r.end,l=r.length,f=r.start;return o(e=i(e)?e:u.tab)&&(e=" ".repeat(e)),""!==n&&"\n"!==n.slice(-1)&&e!==n.slice(-a(e))&&s.select(f-=a(n.split("\n").pop()),l?c:f),l?s.replace(m("^"+(t?"":"(?!$)"),"gm"),e):s.insert(e,-1)},b.replace=function(e,t,r){var n=s.$(),o=n.after,u=n.before,c=n.value;return-1===r?u=u.replace(e,t):1===r?o=o.replace(e,t):c=c.replace(e,t),s.set(u+c+o).select(u=a(u),u+a(c))},b.select=function(){if(x()||S())return e.focus(),s;for(var t=arguments.length,r=Array(t),n=0;n<t;n++)r[n]=arguments[n];var o,u,c,i,l=a(r),f=s.$(),h=f.start,m=f.end;if(o=p.pageXOffset||d.scrollLeft||v.scrollLeft,u=p.pageYOffset||d.scrollTop||v.scrollTop,c=e.scrollLeft,i=e.scrollTop,0===l)r[0]=h,r[1]=m;else if(1===l){if(!0===r[0])return e.focus(),e.select(),s;r[1]=r[0]}return e.focus(),e.selectionStart=r[0],e.selectionEnd=r[1],e.scrollLeft=c,e.scrollTop=i,p.scroll(o,u),s},b.set=function(t){return x()||S()||(e.value=t),s},b.trim=function(e,t,r,n,o){void 0===o&&(o=!0),null!==e&&!1!==e&&(e=e||""),null!==t&&!1!==t&&(t=t||""),null!==r&&!1!==r&&(r=r||""),null!==n&&!1!==n&&(n=n||"");var u=s.$(),c=u.after,i=u.before,l=u.value,f=y(c,-1),p=y(i,1);return c=!1!==t?(f||!o?t:"")+y(c,-1):c,i=!1!==e?y(i,1)+(p||!o?e:""):i,!1!==n&&(l=y(l,1)),!1!==r&&(l=y(l,-1)),s.set(i+l+c).select(i=a(i),i+a(l))},b.wrap=function(e,t,r){var n=s.$(),o=n.after,u=n.before,c=n.value;return r?s.replace(E,e+"$1"+t):s.set(u+e+c+t+o).select(u=a(u+e),u+a(c))},g)L=X,O=H,void 0===(j=void 0)&&(j=!1),e.addEventListener(L,O,j);if(t(u.with))for(var Y=0,q=a(u.with);Y<q;++Y){var z=u.with[Y];l(z)&&(z=w[z]),r(z)?z.call(s,e,u):c(z)&&r(z.attach)&&z.attach.call(s,e,u)}return s},s.attach($)}return w.esc=h,w.state={tab:"\t",with:[]},w.S=function(e,t,r){var n=this,o=r.slice(e,t);n.after=r.slice(t),n.before=r.slice(0,e),n.end=t,n.length=a(o),n.start=e,n.value=o,n.toString=function(){return o}},w.version="4.0.2",w.x=b,w}));