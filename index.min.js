/*!
 *
 * The MIT License (MIT)
 *
 * Copyright © 2024 Taufik Nurrohman <https://github.com/taufik-nurrohman>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the “Software”), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED “AS IS”, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).TextEditor=t()}(this,(function(){"use strict";var e=function(e,t){return-1!==t.indexOf(e)},t=function(e){return Array.isArray(e)},r=function(e){return"function"==typeof e},n=function(e,t){return e&&s(t)&&e instanceof t},o=function(e){return i(e)&&0==e%1},i=function(e){return"number"==typeof e},u=function(e,t){return void 0===t&&(t=!0),"object"==typeof e&&(!t||n(e,Object))},s=function(e){return function(e){return void 0!==e}(e)&&!function(e){return null===e}(e)},c=function(e){return"string"==typeof e},a=function(e){return e.length},l=function(){for(var r=arguments.length,n=Array(r),o=0;o<r;o++)n[o]=arguments[o];for(var i=n.shift(),c=0,f=a(n);c<f;++c)for(var v in n[c])if(s(i[v]))if(t(i[v])&&t(n[c][v])){i[v]=[].concat(i[v]);for(var h=0,p=a(n[c][v]);h<p;++h)e(n[c][v][h],i[v])||i[v].push(n[c][v][h])}else u(i[v])&&u(n[c][v])?i[v]=l({},i[v],n[c][v]):i[v]=n[c][v];else i[v]=n[c][v];return i},f=document,v=window,h=f.body,p=f.documentElement,d=function(e,t){return e.classList.contains(t)},m=function(e,t){return void 0===t&&(t=""),e.replace(b("["+t+g.replace(/./g,"\\$&")+"]"),"\\$&")},b=function(e,t){return function(e){return n(e,RegExp)}(e)?e:RegExp(e,s(t)?t:"g")},g="!$^*()+=[]{}|:<>,.?/-";var y,$=function(e,t,r){t.removeEventListener(e,r)},w=function(e,t,r,n){void 0===n&&(n=!1),t.addEventListener(e,r,n)},_={blur:0,click:0,copy:0,cut:0,focus:0,input:0,keydown:"key.down",keyup:"key.up",mousedown:"mouse.down",mouseenter:"mouse.enter",mouseleave:"mouse.exit",mousemove:"mouse.move",mouseup:"mouse.up",paste:0,scroll:0,touchend:"mouse.up",touchmove:"mouse.move",touchstart:"mouse.down",wheel:"scroll"},k=new WeakMap;function E(e){return k.get(e)}function x(e){return(e.value||"").replace(/\r/g,"")}function L(e){return e.disabled}function S(e,t){return(e||"")["trim"+(-1===t?"Left":1===t?"Right":"")]()}function T(e,t){var r,i,u=this;return e?n(u,T)?(r=e,i=function(e,t){return(t=t||e).fire=function(e,t,r){var n=this,o=n.hooks;return s(o[e])?(o[e].forEach((function(e){return e.apply(r||n,t)})),n):n},t.off=function(e,t){var r=this,n=r.hooks;if(!s(e))return n={},r;if(s(n[e]))if(s(t)){var o=n[e].length;if(0===o)delete n[e];else for(var i=0;i<o;++i)if(t===n[e][i]){n[e].splice(i,1);break}}else delete n[e];return r},t.on=function(e,t){var r=this.hooks;return s(r[e])||(r[e]=[]),s(t)&&r[e].push(t),this},e.hooks={},e}(u,T.prototype),k.set(r,i),u.attach(e,l({},T.state,o(t)||c(t)?{tab:t}:t||{}))):new T(e,t):u}function O(e){var t=E(this),r=e.type,n=x(this);n!==y&&(y=n,t.fire("change")),t.fire(_[r]||r,[e])}T.esc=m,T.from=function(e,t){return new T(e,t)},T.of=E,T.state={n:"text-editor",tab:"\t",with:[]},T.S=function(e,t,r){var n=this,o=r.slice(e,t);n.after=r.slice(t),n.before=r.slice(0,e),n.end=t,n.length=a(o),n.start=e,n.value=o,n.toString=function(){return o}},T.version="4.2.2",T.x=g,Object.defineProperty(T,"name",{value:"TextEditor"});var j=T.prototype;return j.$=function(){var e=this.self;return new T.S(e.selectionStart,e.selectionEnd,x(e))},j.attach=function(e,n){var i=this;if(e=e||i.self,n&&(o(n)||c(n))&&(n={tab:n}),n=l({},i.state,n||{}),d(e,n.n+"__self"))return i;for(var f in i._active=!L(e)&&!function(e){return e.readOnly}(e),i._value=x(e),i.self=e,i.state=n,_)w(f,e,O);if(function(e,t){e.classList.add(t)}(e,n.n+"__self"),s(n)&&t(n.with))for(var v=0,h=a(n.with);v<h;++v){var p=n.with[v];c(p)&&(p=T[p]),r(p)?p.call(i,e,n):u(p)&&r(p.attach)&&p.attach.call(i,e,n)}return i},j.blur=function(){return this.self.blur()},j.detach=function(){var e=this,n=e.self,o=e.state;if(!d(n,o.n+"__self"))return e;for(var i in e._active=!1,_)$(i,n,O);if(function(e,t){e.classList.remove(t)}(n,o.n+"__self"),t(o.with))for(var s=0,l=a(o.with);s<l;++s){var f=o.with[s];c(f)&&(f=T[f]),u(f)&&r(f.detach)&&f.detach.call(e,n,o)}return e},j.focus=function(e){var t,r,n=this,o=n._active,i=n.self;return o?(-1===e?t=r=0:1===e&&(t=a(x(i)),r=i.scrollHeight),s(t)&&s(r)&&(i.selectionStart=i.selectionEnd=t,i.scrollTop=r),i.focus(),n):(i.focus(),n)},j.get=function(){var e=this._active,t=this.self;return!!e&&(!L(t)&&x(t)||null)},j.insert=function(e,t,r){var n=this,o=/^[\s\S]*?$/;return n._active?(r&&n.replace(o,""),-1===t?o=/$/:1===t&&(o=/^/),n.replace(o,e,t)):n},j.let=function(){var e=this,t=e._active,r=e.self;return t?(r.value=e._value,e):e},j.match=function(e,n){var o=this,i=o.$(),u=i.after,s=i.before,c=i.value;if(t(e)){var a=[s.match(e[0]),c.match(e[1]),u.match(e[2])];return r(n)?n.call(o,a[0]||[],a[1]||[],a[2]||[]):[!!a[0],!!a[1],!!a[2]]}var l=c.match(e);return r(n)?n.call(o,l||[]):!!l},j.peel=function(e,t,r){var n=this,o=n.$(),i=o.after,u=o.before,s=o.value;e=m(e),t=m(t);var c=b(e+"$",""),l=b("^"+t,"");return r?n.replace(b("^"+e+"([\\s\\S]*?)"+t+"$",""),"$1"):c.test(u)&&l.test(i)?(u=u.replace(c,""),i=i.replace(l,""),n.set(u+s+i).select(u=a(u),u+a(s))):n.select()},j.pull=function(e,t){void 0===t&&(t=!0);var r=this,n=r.state,i=r.$(),u=i.before,c=i.end,l=i.length,f=i.start,v=i.value;return o(e=s(e)?e:n.tab)&&(e=" ".repeat(e)),""!==u&&"\n"!==u.slice(-1)&&e!==u.slice(-a(e))&&r.select(f-=a(u.split("\n").pop()),l?c:f),e=m(e),l?t?r.replace(b("^"+e,"gm"),""):r.insert(v.split("\n").map((function(t){return b("^("+e+")*$","").test(t)?t:t.replace(b("^"+e,""),"")})).join("\n")):r.replace(b(e+"$",""),"",-1)},j.push=function(e,t){void 0===t&&(t=!1);var r=this,n=r.state,i=r.$(),u=i.before,c=i.end,l=i.length,f=i.start;return o(e=s(e)?e:n.tab)&&(e=" ".repeat(e)),""!==u&&"\n"!==u.slice(-1)&&e!==u.slice(-a(e))&&r.select(f-=a(u.split("\n").pop()),l?c:f),l?r.replace(b("^"+(t?"":"(?!$)"),"gm"),e):r.insert(e,-1)},j.replace=function(e,t,r){var n=this.$(),o=n.after,i=n.before,u=n.value;return-1===r?i=i.replace(e,t):1===r?o=o.replace(e,t):u=u.replace(e,t),this.set(i+u+o).select(i=a(i),i+a(u))},j.select=function(){var e=this,t=e._active,r=e.self;if(!t)return r.focus(),e;for(var n=arguments.length,o=Array(n),i=0;i<n;i++)o[i]=arguments[i];var u,s,c,l,f=a(o),d=e.$(),m=d.start,b=d.end;if(u=v.pageXOffset||p.scrollLeft||h.scrollLeft,s=v.pageYOffset||p.scrollTop||h.scrollTop,c=r.scrollLeft,l=r.scrollTop,0===f)o[0]=m,o[1]=b;else if(1===f){if(!0===o[0])return r.focus(),r.select(),e;o[1]=o[0]}return r.focus(),r.selectionStart=o[0],r.selectionEnd=o[1],r.scrollLeft=c,r.scrollTop=l,v.scroll(u,s),e},j.set=function(e){var t=this,r=t._active,n=t.self;return r?(n.value=e,t):t},j.trim=function(e,t,r,n,o){void 0===o&&(o=!0),null!==e&&!1!==e&&(e=e||""),null!==t&&!1!==t&&(t=t||""),null!==r&&!1!==r&&(r=r||""),null!==n&&!1!==n&&(n=n||"");var i=this.$(),u=i.after,s=i.before,c=i.value,l=S(u,-1),f=S(s,1);return u=!1!==t?(l||!o?t:"")+S(u,-1):u,s=!1!==e?S(s,1)+(f||!o?e:""):s,!1!==n&&(c=S(c,1)),!1!==r&&(c=S(c,-1)),this.set(s+c+u).select(s=a(s),s+a(c))},j.wrap=function(e,t,r){var n=this,o=n.$(),i=o.after,u=o.before,s=o.value;return r?n.replace(/^[\s\S]*?$/,e+"$&"+t):n.set(u+e+s+t+i).select(u=a(u+e),u+a(s))},Object.defineProperty(j,"value",{get:function(){return this.self.value},set:function(e){this.self.value=e}}),T}));