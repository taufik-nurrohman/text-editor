/*!
 *
 * The MIT License (MIT)
 *
 * Copyright © 2024 Taufik Nurrohman <https://github.com/taufik-nurrohman>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the “Software”), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED “AS IS”, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).TextEditor=t()}(this,(function(){"use strict";var e=function(e,t){return-1!==t.indexOf(e)},t=function(e){return Array.isArray(e)},r=function(e){return"function"==typeof e},n=function(e,t){return e&&s(t)&&e instanceof t},i=function(e){return u(e)&&0==e%1},u=function(e){return"number"==typeof e},o=function(e,t){return void 0===t&&(t=!0),"object"==typeof e&&(!t||n(e,Object))},s=function(e){return function(e){return void 0!==e}(e)&&!function(e){return null===e}(e)},c=function(e){return"string"==typeof e},l=function(e){return e.length},a=function e(r){if(t(r))return r.map((function(t){return e(t)}));if(function(e){return/^-?(?:\d*.)?\d+$/.test(e+"")}(r))return function(e,t){return void 0===t&&(t=10),t?parseInt(e,t):parseFloat(e)}(r);if(o(r)){for(var n in r)r[n]=e(r[n]);return r}return"false"!==r&&("null"===r?null:"true"===r||r)},f=function r(){for(var n=arguments.length,i=Array(n),u=0;u<n;u++)i[u]=arguments[u];for(var c=i.shift(),a=0,f=l(i);a<f;++a)for(var v in i[a])if(s(c[v]))if(t(c[v])&&t(i[a][v])){c[v]=[].concat(c[v]);for(var h=0,p=l(i[a][v]);h<p;++h)e(i[a][v][h],c[v])||c[v].push(i[a][v][h])}else o(c[v])&&o(i[a][v])?c[v]=r({},c[v],i[a][v]):c[v]=i[a][v];else c[v]=i[a][v];return c},v=document,h=window,p=v.body,d=v.documentElement,m=function(e,t,r){if(void 0===r&&(r=!0),!b(e,t))return null;var n=e.getAttribute(t);return r?a(n):n},b=function(e,t){return e.hasAttribute(t)},g=function(e,t){return e.classList.contains(t)},y=function(e,t){return void 0===t&&(t=""),e.replace($("["+t+_.replace(/./g,"\\$&")+"]"),"\\$&")},$=function(e,t){return function(e){return n(e,RegExp)}(e)?e:RegExp(e,s(t)?t:"g")},_="!$^*()+=[]{}|:<>,.?/-";var w,E=function(e,t,r){t.removeEventListener(e,r)},k=function(e,t,r,n){void 0===n&&(n=!1),t.addEventListener(e,r,n)},x={blur:0,click:0,copy:0,cut:0,focus:0,input:0,keydown:"key.down",keyup:"key.up",mousedown:"mouse.down",mouseenter:"mouse.enter",mouseleave:"mouse.exit",mousemove:"mouse.move",mouseup:"mouse.up",paste:0,scroll:0,touchend:"mouse.up",touchmove:"mouse.move",touchstart:"mouse.down",wheel:"scroll"},L="TextEditor";function S(e){return(e.value||m(e,"value")||"").replace(/\r/g,"")}function T(e){return e.disabled}function O(e,t){return(e||"")["trim"+(-1===t?"Left":1===t?"Right":"")]()}function j(e,t){var r=this;return e?n(r,j)?(e["_"+L]=function(e,t){return(t=t||e).fire=function(e,t){var r=this,n=r.hooks;return s(n[e])?(n[e].forEach((function(e){return e.apply(r,t)})),r):r},t.off=function(e,t){var r=this,n=r.hooks;if(!s(e))return n={},r;if(s(n[e]))if(s(t)){var i=n[e].length;if(0===i)delete n[e];else for(var u=0;u<i;++u)if(t===n[e][u]){n[e].splice(u,1);break}}else delete n[e];return r},t.on=function(e,t){var r=this.hooks;return s(r[e])||(r[e]=[]),s(t)&&r[e].push(t),this},e.hooks={},e}(r,j.prototype),r.attach(e,f({},j.state,i(t)||c(t)?{tab:t}:t||{}))):new j(e,t):r}function A(e){var t=this["_"+L],r=e.type,n=S(this);n!==w&&(w=n,t.fire("change")),t.fire(x[r]||r,[e])}j.esc=y,j.state={n:"text-editor",tab:"\t",with:[]},j.S=function(e,t,r){var n=this,i=r.slice(e,t);n.after=r.slice(t),n.before=r.slice(0,e),n.end=t,n.length=l(i),n.start=e,n.value=i,n.toString=function(){return i}},j.version="4.1.5",j.x=_,Object.defineProperty(j,"name",{value:L});var R=j.prototype;return R.$=function(){var e=this.self;return new j.S(e.selectionStart,e.selectionEnd,S(e))},R.attach=function(e,n){var i=this;if(e=e||i.self,n=n||i.state,g(e,n.n+"__self"))return i;for(var u in i._active=!T(e)&&!function(e){return e.readOnly}(e),i._value=S(e),i.self=e,i.state=n,x)k(u,e,A);if(function(e,t){e.classList.add(t)}(e,n.n+"__self"),s(n)&&t(n.with))for(var a=0,f=l(n.with);a<f;++a){var v=n.with[a];c(v)&&(v=j[v]),r(v)?v.call(i,e,n):o(v)&&r(v.attach)&&v.attach.call(i,e,n)}return i},R.blur=function(){return this.self.blur()},R.detach=function(){var e=this,n=e.self,i=e.state;if(!g(n,i.n+"__self"))return e;for(var u in e._active=!1,x)E(u,n,A);if(function(e,t){e.classList.remove(t)}(n,i.n+"__self"),t(i.with))for(var s=0,a=l(i.with);s<a;++s){var f=i.with[s];c(f)&&(f=j[f]),o(f)&&r(f.detach)&&f.detach.call(e,n,i)}return e},R.focus=function(e){var t,r,n=this,i=n._active,u=n.self;return i?(-1===e?t=r=0:1===e&&(t=l(S(u)),r=u.scrollHeight),s(t)&&s(r)&&(u.selectionStart=u.selectionEnd=t,u.scrollTop=r),u.focus(),n):(u.focus(),n)},R.get=function(){var e=this._active,t=this.self;return!!e&&(!T(t)&&S(t)||null)},R.insert=function(e,t,r){var n=this,i=/^[\s\S]*?$/;return n._active?(r&&n.replace(i,""),-1===t?i=/$/:1===t&&(i=/^/),n.replace(i,e,t)):n},R.let=function(){var e=this,t=e._active,r=e.self;return t?(r.value=e._value,e):e},R.match=function(e,n){var i=this,u=i.$(),o=u.after,s=u.before,c=u.value;if(t(e)){var l=[s.match(e[0]),c.match(e[1]),o.match(e[2])];return r(n)?n.call(i,l[0]||[],l[1]||[],l[2]||[]):[!!l[0],!!l[1],!!l[2]]}var a=c.match(e);return r(n)?n.call(i,a||[]):!!a},R.peel=function(e,t,r){var n=this,i=n.$(),u=i.after,o=i.before,s=i.value;e=y(e),t=y(t);var c=$(e+"$",""),a=$("^"+t,"");return r?n.replace($("^"+e+"([\\s\\S]*?)"+t+"$",""),"$1"):c.test(o)&&a.test(u)?(o=o.replace(c,""),u=u.replace(a,""),n.set(o+s+u).select(o=l(o),o+l(s))):n.select()},R.pull=function(e,t){void 0===t&&(t=!0);var r=this,n=r.state,u=r.$(),o=u.before,c=u.end,a=u.length,f=u.start,v=u.value;return i(e=s(e)?e:n.tab)&&(e=" ".repeat(e)),""!==o&&"\n"!==o.slice(-1)&&e!==o.slice(-l(e))&&r.select(f-=l(o.split("\n").pop()),a?c:f),e=y(e),a?t?r.replace($("^"+e,"gm"),""):r.insert(v.split("\n").map((function(t){return $("^("+e+")*$","").test(t)?t:t.replace($("^"+e,""),"")})).join("\n")):r.replace($(e+"$",""),"",-1)},R.push=function(e,t){void 0===t&&(t=!1);var r=this,n=r.state,u=r.$(),o=u.before,c=u.end,a=u.length,f=u.start;return i(e=s(e)?e:n.tab)&&(e=" ".repeat(e)),""!==o&&"\n"!==o.slice(-1)&&e!==o.slice(-l(e))&&r.select(f-=l(o.split("\n").pop()),a?c:f),a?r.replace($("^"+(t?"":"(?!$)"),"gm"),e):r.insert(e,-1)},R.replace=function(e,t,r){var n=this.$(),i=n.after,u=n.before,o=n.value;return-1===r?u=u.replace(e,t):1===r?i=i.replace(e,t):o=o.replace(e,t),this.set(u+o+i).select(u=l(u),u+l(o))},R.select=function(){var e=this,t=e._active,r=e.self;if(!t)return r.focus(),e;for(var n=arguments.length,i=Array(n),u=0;u<n;u++)i[u]=arguments[u];var o,s,c,a,f=l(i),v=e.$(),m=v.start,b=v.end;if(o=h.pageXOffset||d.scrollLeft||p.scrollLeft,s=h.pageYOffset||d.scrollTop||p.scrollTop,c=r.scrollLeft,a=r.scrollTop,0===f)i[0]=m,i[1]=b;else if(1===f){if(!0===i[0])return r.focus(),r.select(),e;i[1]=i[0]}return r.focus(),r.selectionStart=i[0],r.selectionEnd=i[1],r.scrollLeft=c,r.scrollTop=a,h.scroll(o,s),e},R.set=function(e){var t=this,r=t._active,n=t.self;return r?(n.value=e,t):t},R.trim=function(e,t,r,n,i){void 0===i&&(i=!0),null!==e&&!1!==e&&(e=e||""),null!==t&&!1!==t&&(t=t||""),null!==r&&!1!==r&&(r=r||""),null!==n&&!1!==n&&(n=n||"");var u=this.$(),o=u.after,s=u.before,c=u.value,a=O(o,-1),f=O(s,1);return o=!1!==t?(a||!i?t:"")+O(o,-1):o,s=!1!==e?O(s,1)+(f||!i?e:""):s,!1!==n&&(c=O(c,1)),!1!==r&&(c=O(c,-1)),this.set(s+c+o).select(s=l(s),s+l(c))},R.wrap=function(e,t,r){var n=this,i=n.$(),u=i.after,o=i.before,s=i.value;return r?n.replace(/^[\s\S]*?$/,e+"$&"+t):n.set(o+e+s+t+u).select(o=l(o+e),o+l(s))},Object.defineProperty(R,"value",{get:function(){return this.self.value},set:function(e){this.self.value=e}}),j}));