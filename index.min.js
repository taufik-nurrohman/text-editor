/*!
 *
 * The MIT License (MIT)
 *
 * Copyright © 2024 Taufik Nurrohman <https://github.com/taufik-nurrohman>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the “Software”), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED “AS IS”, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).TextEditor=t()}(this,(function(){"use strict";var e=function(e,t){return-1!==t.indexOf(e)},t=function(e){return Array.isArray(e)},r=function(e){return"function"==typeof e},n=function(e,t){return e&&c(t)&&e instanceof t},o=function(e){return i(e)&&0==e%1},i=function(e){return"number"==typeof e},u=function(e,t){return void 0===t&&(t=!0),"object"==typeof e&&(!t||n(e,Object))},c=function(e){return function(e){return void 0!==e}(e)&&!function(e){return null===e}(e)},a=function(e){return"string"==typeof e},l=function(e){return e.length},s=function r(){for(var n=arguments.length,o=Array(n),i=0;i<n;i++)o[i]=arguments[i];for(var a=o.shift(),s=0,f=l(o);s<f;++s)for(var v in o[s])if(c(a[v]))if(t(a[v])&&t(o[s][v])){a[v]=[].concat(a[v]);for(var p=0,h=l(o[s][v]);p<h;++p)e(o[s][v][p],a[v])||a[v].push(o[s][v][p])}else u(a[v])&&u(o[s][v])?a[v]=r({},a[v],o[s][v]):a[v]=o[s][v];else a[v]=o[s][v];return a},f=document,v=window,p=f.body,h=f.documentElement,d=function(e,t){return void 0===t&&(t=""),e.replace(m("["+t+b.replace(/./g,"\\$&")+"]"),"\\$&")},m=function(e,t){return function(e){return n(e,RegExp)}(e)?e:RegExp(e,c(t)?t:"g")},b="!$^*()+=[]{}|:<>,.?/-";var g=function(e){return e.disabled},y=function(e){return e.readOnly},$=function(e){return e.value.replace(/\r/g,"")},w={blur:0,click:0,copy:0,cut:0,focus:0,input:0,keydown:"key.down",keyup:"key.up",mousedown:"mouse.down",mouseenter:"mouse.enter",mouseleave:"mouse.exit",mousemove:"mouse.move",mouseup:"mouse.up",paste:0,scroll:0,touchend:"mouse.up",touchmove:"mouse.move",touchstart:"mouse.down",wheel:"scroll"};function E(e,t){return(e||"")["trim"+(-1===t?"Left":1===t?"Right":"")]()}function S(e,t){var r=this;return e?n(r,S)?(function(e){var t={},r=e.constructor.prototype;e.hooks=t,r.fire=function(r,n){return c(t[r])?(t[r].forEach((function(t){return t.apply(e,n)})),e):e},r.off=function(r,n){if(!c(r))return t={},e;if(c(t[r]))if(c(n)){var o=t[r].length;if(0===o)delete t[r];else for(var i=0;i<o;++i)if(n===t[r][i]){t[r].splice(i,1);break}}else delete t[r];return e},r.on=function(r,n){return c(t[r])||(t[r]=[]),c(n)&&t[r].push(n),e}}(r),e._fire=r.fire,r.attach(e,s({},S.state,o(t)||a(t)?{tab:t}:t||{}))):new S(e,t):r}S.esc=d,S.state={tab:"\t",with:[]},S.S=function(e,t,r){var n=this,o=r.slice(e,t);n.after=r.slice(t),n.before=r.slice(0,e),n.end=t,n.length=l(o),n.start=e,n.value=o,n.toString=function(){return o}},S.version="4.0.3",S.x=b;var x,T=S.prototype,k=function(e){var t=this._fire,r=e.type,n=$(this);n!==x&&(x=n,t("change",[e])),t(w[r]||r,[e])};return T.$=function(){var e=this.self;return new S.S(e.selectionStart,e.selectionEnd,$(e))},T.attach=function(e,n){var o,i,s,f=this;for(var v in f.active=!0,f.self=e,c(n)&&(f.state=n),f.value=$(e),w)o=v,i=k,void 0===(s=void 0)&&(s=!1),e.addEventListener(o,i,s);if(c(n)&&t(n.with))for(var p=0,h=l(n.with);p<h;++p){var d=n.with[p];a(d)&&(d=S[d]),r(d)?d.call(f,e,n):u(d)&&r(d.attach)&&d.attach.call(f,e,n)}return f},T.blur=function(){var e=this,t=e.active,r=e.self;return t?(r.blur(),e):e},T.detach=function(){var e,n,o=this,i=o.self,c=o.state;for(var s in o.active=!1,w)e=s,n=k,i.removeEventListener(e,n);if(t(c.with))for(var f=0,v=l(c.with);f<v;++f){var p=c.with[f];a(p)&&(p=S[p]),u(p)&&r(p.detach)&&p.detach.call(o,i,c)}return o},T.focus=function(e){var t,r,n=this,o=n.active,i=n.self;return o?(-1===e?t=r=0:1===e&&(t=l($(i)),r=i.scrollHeight),c(t)&&c(r)&&(i.selectionStart=i.selectionEnd=t,i.scrollTop=r),i.focus(),n):n},T.get=function(){var e=this.active,t=this.self;return e&&!g(t)&&$(t)||null},T.insert=function(e,t,r){var n=this,o=/^([\s\S]*?)$/;return n.active?(r&&n.replace(o,""),-1===t?o=/$/:1===t&&(o=/^/),n.replace(o,e,t)):n},T.let=function(){var e=this,t=e.active,r=e.self;return t?(r.value=e.value,e):e},T.match=function(e,n){var o=this,i=o.$(),u=i.after,c=i.before,a=i.value;if(t(e)){var l=[c.match(e[0]),a.match(e[1]),u.match(e[2])];return r(n)?n.call(o,l[0]||[],l[1]||[],l[2]||[]):[!!l[0],!!l[1],!!l[2]]}var s=a.match(e);return r(n)?n.call(o,s||[]):!!s},T.peel=function(e,t,r){var n=this,o=n.$(),i=o.after,u=o.before,c=o.value;e=d(e),t=d(t);var a=m(e+"$",""),s=m("^"+t,"");return r?n.replace(m("^"+e+"([\\s\\S]*?)"+t+"$",""),"$1"):a.test(u)&&s.test(i)?(u=u.replace(a,""),i=i.replace(s,""),n.set(u+c+i).select(u=l(u),u+l(c))):n.select()},T.pull=function(e,t){void 0===t&&(t=!0);var r=this,n=r.state,i=r.$(),u=i.before,a=i.end,s=i.length,f=i.start,v=i.value;return o(e=c(e)?e:n.tab)&&(e=" ".repeat(e)),""!==u&&"\n"!==u.slice(-1)&&e!==u.slice(-l(e))&&r.select(f-=l(u.split("\n").pop()),s?a:f),e=d(e),s?t?r.replace(m("^"+e,"gm"),""):r.insert(v.split("\n").map((function(t){return m("^("+e+")*$","").test(t)?t:t.replace(m("^"+e,""),"")})).join("\n")):r.replace(m(e+"$",""),"",-1)},T.push=function(e,t){void 0===t&&(t=!1);var r=this,n=r.state,i=r.$(),u=i.before,a=i.end,s=i.length,f=i.start;return o(e=c(e)?e:n.tab)&&(e=" ".repeat(e)),""!==u&&"\n"!==u.slice(-1)&&e!==u.slice(-l(e))&&r.select(f-=l(u.split("\n").pop()),s?a:f),s?r.replace(m("^"+(t?"":"(?!$)"),"gm"),e):r.insert(e,-1)},T.replace=function(e,t,r){var n=this.$(),o=n.after,i=n.before,u=n.value;return-1===r?i=i.replace(e,t):1===r?o=o.replace(e,t):u=u.replace(e,t),this.set(i+u+o).select(i=l(i),i+l(u))},T.select=function(){var e=this,t=e.active,r=e.self;if(!t)return e;if(g(r)||y(r))return r.focus(),e;for(var n=arguments.length,o=Array(n),i=0;i<n;i++)o[i]=arguments[i];var u,c,a,s,f=l(o),d=e.$(),m=d.start,b=d.end;if(u=v.pageXOffset||h.scrollLeft||p.scrollLeft,c=v.pageYOffset||h.scrollTop||p.scrollTop,a=r.scrollLeft,s=r.scrollTop,0===f)o[0]=m,o[1]=b;else if(1===f){if(!0===o[0])return r.focus(),r.select(),e;o[1]=o[0]}return r.focus(),r.selectionStart=o[0],r.selectionEnd=o[1],r.scrollLeft=a,r.scrollTop=s,v.scroll(u,c),e},T.set=function(e){var t=this,r=t.active,n=t.self;return r?(g(n)||y(n)||(n.value=e),t):t},T.trim=function(e,t,r,n,o){void 0===o&&(o=!0),null!==e&&!1!==e&&(e=e||""),null!==t&&!1!==t&&(t=t||""),null!==r&&!1!==r&&(r=r||""),null!==n&&!1!==n&&(n=n||"");var i=this.$(),u=i.after,c=i.before,a=i.value,s=E(u,-1),f=E(c,1);return u=!1!==t?(s||!o?t:"")+E(u,-1):u,c=!1!==e?E(c,1)+(f||!o?e:""):c,!1!==n&&(a=E(a,1)),!1!==r&&(a=E(a,-1)),this.set(c+a+u).select(c=l(c),c+l(a))},T.wrap=function(e,t,r){var n=this,o=n.$(),i=o.after,u=o.before,c=o.value;return r?n.replace(/^([\s\S]*?)$/,e+"$1"+t):n.set(u+e+c+t+i).select(u=l(u+e),u+l(c))},S}));