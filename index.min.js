/*!
 *
 * The MIT License (MIT)
 *
 * Copyright © 2024 Taufik Nurrohman <https://github.com/taufik-nurrohman>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the “Software”), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED “AS IS”, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).TextEditor=t()}(this,(function(){"use strict";function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}var t=function(e,t){return-1!==t.indexOf(e)},n=function(e){return Array.isArray(e)},r=function(e){return"function"==typeof e},o=function(e,t){return e&&c(t)&&e instanceof t},i=function(e){return u(e)&&0==e%1},u=function(e){return"number"==typeof e},s=function(t){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return"object"===e(t)&&(!n||o(t,Object))},c=function(e){return function(e){return void 0!==e}(e)&&!function(e){return null===e}(e)},l=function(e){return"string"==typeof e},f=function(e){return e.length},a=function(){for(var e=arguments.length,r=Array(e),o=0;o<e;o++)r[o]=arguments[o];for(var i=r.shift(),u=0,l=f(r);u<l;++u)for(var v in r[u])if(c(i[v]))if(n(i[v])&&n(r[u][v])){i[v]=[].concat(i[v]);for(var h=0,p=f(r[u][v]);h<p;++h)t(r[u][v][h],i[v])||i[v].push(r[u][v][h])}else s(i[v])&&s(r[u][v])?i[v]=a({},i[v],r[u][v]):i[v]=r[u][v];else i[v]=r[u][v];return i},v=document,h=window,p=v.body,d=v.documentElement,m=function(e,t){return e.classList.contains(t)},y=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return e.replace(b("["+t+g.replace(/./g,"\\$&")+"]"),"\\$&")},b=function(e,t){return function(e){return o(e,RegExp)}(e)?e:RegExp(e,c(t)?t:"g")},g="!$^*()+=[]{}|:<>,.?/-";var $,w=function(e,t,n){t.removeEventListener(e,n)},_=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];t.addEventListener(e,n,r)},S={blur:0,click:0,copy:0,cut:0,focus:0,input:0,keydown:"key.down",keyup:"key.up",mousedown:"mouse.down",mouseenter:"mouse.enter",mouseleave:"mouse.exit",mousemove:"mouse.move",mouseup:"mouse.up",paste:0,scroll:0,touchend:"mouse.up",touchmove:"mouse.move",touchstart:"mouse.down",wheel:"scroll"},k=new WeakMap;function E(e){return k.get(e)}function x(e){return(e.value||"").replace(/\r/g,"")}function L(e){return e.disabled}function T(e,t){return(e||"")["trim"+(-1===t?"Left":1===t?"Right":"")]()}function O(e,t){var n,r,u=this;return e?o(u,O)?(n=e,r=function(e,t){return(t=t||e).fire=function(e,t,n){var r=this,o=r.hooks;return c(o[e])?(o[e].forEach((function(e){return e.apply(n||r,t)})),r):r},t.off=function(e,t){var n=this,r=n.hooks;if(!c(e))return r={},n;if(c(r[e]))if(c(t)){var o=r[e].length;if(0===o)delete r[e];else for(var i=0;i<o;++i)if(t===r[e][i]){r[e].splice(i,1);break}}else delete r[e];return n},t.on=function(e,t){var n=this.hooks;return c(n[e])||(n[e]=[]),c(t)&&n[e].push(t),this},e.hooks={},e}(u,O.prototype),k.set(n,r),u.attach(e,a({},O.state,i(t)||l(t)?{tab:t}:t||{}))):new O(e,t):u}function j(e){var t=E(this),n=e.type,r=x(this);r!==$&&($=r,t.fire("change")),t.fire(S[n]||n,[e])}O.esc=y,O.from=function(e,t){return new O(e,t)},O.of=E,O.state={n:"text-editor",tab:"\t",with:[]},O.S=function(e,t,n){var r=this,o=n.slice(e,t);r.after=n.slice(t),r.before=n.slice(0,e),r.end=t,r.length=f(o),r.start=e,r.value=o,r.toString=function(){return o}},O.version="4.2.1",O.x=g,Object.defineProperty(O,"name",{value:"TextEditor"});var A=O.prototype;return A.$=function(){var e=this.self;return new O.S(e.selectionStart,e.selectionEnd,x(e))},A.attach=function(e,t){var o=this;if(e=e||o.self,t&&(i(t)||l(t))&&(t={tab:t}),t=a({},o.state,t||{}),m(e,t.n+"__self"))return o;for(var u in o._active=!L(e)&&!function(e){return e.readOnly}(e),o._value=x(e),o.self=e,o.state=t,S)_(u,e,j);if(function(e,t){e.classList.add(t)}(e,t.n+"__self"),c(t)&&n(t.with))for(var v=0,h=f(t.with);v<h;++v){var p=t.with[v];l(p)&&(p=O[p]),r(p)?p.call(o,e,t):s(p)&&r(p.attach)&&p.attach.call(o,e,t)}return o},A.blur=function(){return this.self.blur()},A.detach=function(){var e=this,t=e.self,o=e.state;if(!m(t,o.n+"__self"))return e;for(var i in e._active=!1,S)w(i,t,j);if(function(e,t){e.classList.remove(t)}(t,o.n+"__self"),n(o.with))for(var u=0,c=f(o.with);u<c;++u){var a=o.with[u];l(a)&&(a=O[a]),s(a)&&r(a.detach)&&a.detach.call(e,t,o)}return e},A.focus=function(e){var t,n,r=this,o=r._active,i=r.self;return o?(-1===e?t=n=0:1===e&&(t=f(x(i)),n=i.scrollHeight),c(t)&&c(n)&&(i.selectionStart=i.selectionEnd=t,i.scrollTop=n),i.focus(),r):(i.focus(),r)},A.get=function(){var e=this._active,t=this.self;return!!e&&(!L(t)&&x(t)||null)},A.insert=function(e,t,n){var r=this,o=/^[\s\S]*?$/;return r._active?(n&&r.replace(o,""),-1===t?o=/$/:1===t&&(o=/^/),r.replace(o,e,t)):r},A.let=function(){var e=this,t=e._active,n=e.self;return t?(n.value=e._value,e):e},A.match=function(e,t){var o=this,i=o.$(),u=i.after,s=i.before,c=i.value;if(n(e)){var l=[s.match(e[0]),c.match(e[1]),u.match(e[2])];return r(t)?t.call(o,l[0]||[],l[1]||[],l[2]||[]):[!!l[0],!!l[1],!!l[2]]}var f=c.match(e);return r(t)?t.call(o,f||[]):!!f},A.peel=function(e,t,n){var r=this,o=r.$(),i=o.after,u=o.before,s=o.value;e=y(e),t=y(t);var c=b(e+"$",""),l=b("^"+t,"");return n?r.replace(b("^"+e+"([\\s\\S]*?)"+t+"$",""),"$1"):c.test(u)&&l.test(i)?(u=u.replace(c,""),i=i.replace(l,""),r.set(u+s+i).select(u=f(u),u+f(s))):r.select()},A.pull=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this,r=n.state,o=n.$(),u=o.before,s=o.end,l=o.length,a=o.start,v=o.value;return i(e=c(e)?e:r.tab)&&(e=" ".repeat(e)),""!==u&&"\n"!==u.slice(-1)&&e!==u.slice(-f(e))&&n.select(a-=f(u.split("\n").pop()),l?s:a),e=y(e),l?t?n.replace(b("^"+e,"gm"),""):n.insert(v.split("\n").map((function(t){return b("^("+e+")*$","").test(t)?t:t.replace(b("^"+e,""),"")})).join("\n")):n.replace(b(e+"$",""),"",-1)},A.push=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this,r=n.state,o=n.$(),u=o.before,s=o.end,l=o.length,a=o.start;return i(e=c(e)?e:r.tab)&&(e=" ".repeat(e)),""!==u&&"\n"!==u.slice(-1)&&e!==u.slice(-f(e))&&n.select(a-=f(u.split("\n").pop()),l?s:a),l?n.replace(b("^"+(t?"":"(?!$)"),"gm"),e):n.insert(e,-1)},A.replace=function(e,t,n){var r=this.$(),o=r.after,i=r.before,u=r.value;return-1===n?i=i.replace(e,t):1===n?o=o.replace(e,t):u=u.replace(e,t),this.set(i+u+o).select(i=f(i),i+f(u))},A.select=function(){var e=this,t=e._active,n=e.self;if(!t)return n.focus(),e;for(var r=arguments.length,o=Array(r),i=0;i<r;i++)o[i]=arguments[i];var u,s,c,l,a=f(o),v=e.$(),m=v.start,y=v.end;if(u=h.pageXOffset||d.scrollLeft||p.scrollLeft,s=h.pageYOffset||d.scrollTop||p.scrollTop,c=n.scrollLeft,l=n.scrollTop,0===a)o[0]=m,o[1]=y;else if(1===a){if(!0===o[0])return n.focus(),n.select(),e;o[1]=o[0]}return n.focus(),n.selectionStart=o[0],n.selectionEnd=o[1],n.scrollLeft=c,n.scrollTop=l,h.scroll(u,s),e},A.set=function(e){var t=this,n=t._active,r=t.self;return n?(r.value=e,t):t},A.trim=function(e,t,n,r){var o=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];null!==e&&!1!==e&&(e=e||""),null!==t&&!1!==t&&(t=t||""),null!==n&&!1!==n&&(n=n||""),null!==r&&!1!==r&&(r=r||"");var i=this.$(),u=i.after,s=i.before,c=i.value,l=T(u,-1),a=T(s,1);return u=!1!==t?(l||!o?t:"")+T(u,-1):u,s=!1!==e?T(s,1)+(a||!o?e:""):s,!1!==r&&(c=T(c,1)),!1!==n&&(c=T(c,-1)),this.set(s+c+u).select(s=f(s),s+f(c))},A.wrap=function(e,t,n){var r=this,o=r.$(),i=o.after,u=o.before,s=o.value;return n?r.replace(/^[\s\S]*?$/,e+"$&"+t):r.set(u+e+s+t+i).select(u=f(u+e),u+f(s))},Object.defineProperty(A,"value",{get:function(){return this.self.value},set:function(e){this.self.value=e}}),O}));