/*!
 *
 * The MIT License (MIT)
 *
 * Copyright © 2024 Taufik Nurrohman <https://github.com/taufik-nurrohman>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the “Software”), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED “AS IS”, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).TextEditor=t()}(this,(function(){"use strict";var e=function(e,t){return-1!==t.indexOf(e)},t=function(e){return Array.isArray(e)},r=function(e){return"function"==typeof e},n=function(e,t,r){return!(!e||"object"!=typeof e)&&(r?u(t)&&u(e.constructor)&&t===e.constructor:u(t)&&e instanceof t)},i=function(e){return o(e)&&0==e%1},o=function(e){return"number"==typeof e},c=function(e,t){return void 0===t&&(t=!0),!(!e||"object"!=typeof e)&&(!t||n(e,Object,1))},u=function(e){return function(e){return void 0!==e}(e)&&!function(e){return null===e}(e)},a=function(e){return"string"==typeof e},s=function(e){return e.length},l=function(){for(var r=arguments.length,n=Array(r),i=0;i<r;i++)n[i]=arguments[i];for(var o=n.shift(),a=0,f=s(n);a<f;++a)for(var v in n[a])if(u(o[v]))if(t(o[v])&&t(n[a][v])){o[v]=[].concat(o[v]);for(var h=0,p=s(n[a][v]);h<p;++h)e(n[a][v][h],o[v])||o[v].push(n[a][v][h])}else c(o[v])&&c(n[a][v])?o[v]=l({},o[v],n[a][v]):o[v]=n[a][v];else o[v]=n[a][v];return o},f=document,v=window,h=f.body,p=f.documentElement,d=function(e,t){return e.classList.contains(t)},m=function(e,t){return void 0===t&&(t=""),e.replace(b("["+t+g.replace(/./g,"\\$&")+"]"),"\\$&")},b=function(e,t){return function(e){return n(e,RegExp)}(e)?e:RegExp(e,u(t)?t:"g")},g="!$^*()+=[]{}|:<>,.?/-";var y=function(e,t,r){t.removeEventListener(e,r)},$=function(e,t,r,n){void 0===n&&(n=!1),t.addEventListener(e,r,n)},_={blur:0,click:0,copy:0,cut:0,focus:0,input:0,keydown:"key.down",keyup:"key.up",mousedown:"caret.down",mouseenter:"caret.enter",mouseleave:"caret.exit",mousemove:"caret.move",mouseup:"caret.up",paste:0,scroll:0,select:0,touchend:"caret.up",touchmove:"caret.move",touchstart:"caret.down",wheel:"scroll"},w=new WeakMap;function k(e){return t=e,w.get(t)||null;var t}function E(e){return(e.value||"").replace(/\r/g,"")}function x(e){return e.disabled}function L(e,t){e.value=t}function T(e,t){return(e||"")["trim"+(-1===t?"Left":1===t?"Right":"")]()}function S(e,t){var r,o,c,s,f=this;return e?n(f,S)?(r=e,o=function(e,t){return(t=t||e).fire=function(e,t,r){var n=this,i=n.hooks;return u(i[e])?(i[e].forEach((function(e){return e.apply(r||n,t)})),n):n},t.off=function(e,t){var r=this,n=r.hooks;if(!u(e))return n={},r;if(u(n[e]))if(u(t)){var i=n[e].length;if(0===i)delete n[e];else for(var o=0;o<i;++o)if(t===n[e][o]){n[e].splice(o,1);break}}else delete n[e];return r},t.on=function(e,t){var r=this.hooks;return u(r[e])||(r[e]=[]),u(t)&&r[e].push(t),this},e.hooks={},e}(f,S._),c=r,s=o,w.set(c,s),f.attach(e,l({},S.state,i(t)||a(t)?{tab:t}:t||{}))):new S(e,t):f}S.esc=m,S.from=function(e,t){return new S(e,t)},S.of=k,S.state={n:"text-editor",tab:"\t",with:[]},S.version="4.2.9",S.x=g;var j,O=function(e,t,r){var n=this,i=r.slice(e,t);n.after=r.slice(t),n.before=r.slice(0,e),n.end=t,n.length=s(i),n.start=e,n.value=i};function A(e){var t=k(this),r=E(this);e.data;var n=e.type;t._event=e,r!==j&&(a(j)&&t.fire("change",[e]),j=r),t.fire(_[n]||n,[e])}O.prototype.toString=function(){return this.value},S.S=O,Object.defineProperty(S,"name",{value:"TextEditor"});var R=S._=S.prototype;return R.$=function(){var e=this.self;return new O(e.selectionStart,e.selectionEnd,E(e))},R.attach=function(e,n){var o=this;if(e=e||o.self,n&&(i(n)||a(n))&&(n={tab:n}),n=l({},o.state,n||{}),d(e,n.n+"__self"))return o;for(var f in o._active=!x(e)&&!function(e){return e.readOnly}(e),o._event=null,o._value=E(e),o.self=e,o.state=n,_)$(f,e,A);if(function(e,t){e.classList.add(t)}(e,n.n+"__self"),u(n)&&t(n.with))for(var v=0,h=s(n.with);v<h;++v){var p=n.with[v];a(p)&&(p=S[p]),r(p)?p.call(o,e,n):c(p)&&r(p.attach)&&p.attach.call(o,e,n)}return o},R.blur=function(){return this.self.blur()},R.detach=function(){var e=this,n=e.self,i=e.state;if(!d(n,i.n+"__self"))return e;for(var o in e._active=!1,_)y(o,n,A);if(function(e,t){e.classList.remove(t)}(n,i.n+"__self"),t(i.with))for(var u=0,l=s(i.with);u<l;++u){var f=i.with[u];a(f)&&(f=S[f]),c(f)&&r(f.detach)&&f.detach.call(e,n,i)}return e},R.focus=function(e){var t,r,n=this,i=n._active,o=n.self;return i?(-1===e?t=r=0:1===e&&(t=s(E(o)),r=o.scrollHeight),u(t)&&u(r)&&(o.selectionStart=o.selectionEnd=t,o.scrollTop=r),o.focus(),n):(o.focus(),n)},R.get=function(){var e=this._active,t=this.self;return!!e&&(!x(t)&&E(t)||null)},R.insert=function(e,t,r){var n=this,i=/^[\s\S]*?$/;return n._active?(r&&n.replace(i,""),-1===t?i=/$/:1===t&&(i=/^/),n.replace(i,e,t)):n},R.let=function(){var e=this,t=e._active,r=e.self;return t?(L(r,e._value),e):e},R.match=function(e,n){var i=this,o=i.$(),c=o.after,u=o.before,a=o.value;if(t(e)){var s=[u.match(e[0]),a.match(e[1]),c.match(e[2])];return r(n)?n.call(i,s[0]||[],s[1]||[],s[2]||[]):[!!s[0],!!s[1],!!s[2]]}var l=a.match(e);return r(n)?n.call(i,l||[]):!!l},R.peel=function(e,t,r){var n=this,i=n.$(),o=i.after,c=i.before,u=i.value;e=m(e),t=m(t);var a=b(e+"$",""),l=b("^"+t,"");return r?n.replace(b("^"+e+"([\\s\\S]*?)"+t+"$",""),"$1"):a.test(c)&&l.test(o)?(c=c.replace(a,""),o=o.replace(l,""),n.set(c+u+o).select(c=s(c),c+s(u))):n.select()},R.pull=function(e,t){void 0===t&&(t=!0);var r=this,n=r.state,o=r.$(),c=o.before,a=o.end,l=o.length,f=o.start,v=o.value;return i(e=u(e)?e:n.tab)&&(e=" ".repeat(e)),""!==c&&"\n"!==c.slice(-1)&&e!==c.slice(-s(e))&&r.select(f-=s(c.split("\n").pop()),l?a:f),e=m(e),l?t?r.replace(b("^"+e,"gm"),""):r.insert(v.split("\n").map((function(t){return b("^("+e+")*$","").test(t)?t:t.replace(b("^"+e,""),"")})).join("\n")):r.replace(b(e+"$",""),"",-1)},R.push=function(e,t){void 0===t&&(t=!1);var r=this,n=r.state,o=r.$(),c=o.before,a=o.end,l=o.length,f=o.start;return i(e=u(e)?e:n.tab)&&(e=" ".repeat(e)),""!==c&&"\n"!==c.slice(-1)&&e!==c.slice(-s(e))&&r.select(f-=s(c.split("\n").pop()),l?a:f),l?r.replace(b("^"+(t?"":"(?!$)"),"gm"),e):r.insert(e,-1)},R.replace=function(e,t,r){var n=this.$(),i=n.after,o=n.before,c=n.value;return-1===r?o=o.replace(e,t):1===r?i=i.replace(e,t):c=c.replace(e,t),this.set(o+c+i).select(o=s(o),o+s(c))},R.select=function(){var e=this,t=e._active,r=e.self;if(!t)return r.focus(),e;for(var n=arguments.length,i=Array(n),o=0;o<n;o++)i[o]=arguments[o];var c,u,a,l,f=s(i),d=e.$(),m=d.start,b=d.end;if(c=v.pageXOffset||p.scrollLeft||h.scrollLeft,u=v.pageYOffset||p.scrollTop||h.scrollTop,a=r.scrollLeft,l=r.scrollTop,0===f)i[0]=m,i[1]=b;else if(1===f){if(!0===i[0])return r.focus(),r.select(),e;i[1]=i[0]}return r.focus(),r.selectionStart=i[0],r.selectionEnd=i[1],r.scrollLeft=a,r.scrollTop=l,v.scroll(c,u),e},R.set=function(e){var t=this,r=t._active,n=t.self;return r?(L(n,e),t):t},R.trim=function(e,t,r,n,i){void 0===i&&(i=!0),null!==e&&!1!==e&&(e=e||""),null!==t&&!1!==t&&(t=t||""),null!==r&&!1!==r&&(r=r||""),null!==n&&!1!==n&&(n=n||"");var o=this.$(),c=o.after,u=o.before,a=o.value,l=T(c,-1),f=T(u,1);return c=!1!==t?(l||!i?t:"")+T(c,-1):c,u=!1!==e?T(u,1)+(f||!i?e:""):u,!1!==n&&(a=T(a,1)),!1!==r&&(a=T(a,-1)),this.set(u+a+c).select(u=s(u),u+s(a))},R.wrap=function(e,t,r){var n=this,i=n.$(),o=i.after,c=i.before,u=i.value;return r?n.replace(/^[\s\S]*?$/,e+"$&"+t):n.set(c+e+u+t+o).select(c=s(c+e),c+s(u))},Object.defineProperty(R,"value",{get:function(){return E(this.self)},set:function(e){L(this.self,e)}}),S}));