/*!
 *
 * The MIT License (MIT)
 *
 * Copyright © 2021 Taufik Nurrohman
 *
 * <https://github.com/taufik-nurrohman/text-editor>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the “Software”), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED “AS IS”, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */
!function(){"use strict";var e=function(e){return function(e){return void 0!==e}(e)&&!function(e){return null===e}(e)},r=function(e){return e&&e.preventDefault()},t=function(e,r){return e in r},n=function(e,r){return void 0===r&&(r=""),e.replace(u("["+r+c.replace(/./g,"\\$&")+"]"),"\\$&")},o=function(r){return function(r,t){return r&&e(t)&&r instanceof t}(r,RegExp)},u=function(r,t){return o(r)?r:(r=r.replace(/\//g,"\\/"),RegExp(r,e(t)?t:"g"))},c="!$^*()+=[]{}|:<>,.?/-";if(e(TE)){var i=TE;function l(e,o){void 0===o&&(o={});var c=this;i.call(c,e,o),o=c.state;var l=t("source",o)?o.source:{};if(!l)return c;var a={},s=c.pop,f=t("undo",i.prototype);a.close={"`":"`","(":")","{":"}","[":"]",'"':'"',"'":"'","<":">"},a.pull=function(e){var r=e.key,t=e.keyCode,n=e.ctrlKey,o=e.shiftKey;return n&&!o&&(r&&"["===r||t&&219===t)},a.push=function(e){var r=e.key,t=e.keyCode,n=e.ctrlKey,o=e.shiftKey;return n&&!o&&(r&&"]"===r||t&&221===t)},l&&(o.source=function(){for(var e=arguments.length,r=Array(e),t=0;t<e;t++)r[t]=arguments[t];return Object.assign.apply(Object,[{}].concat(r))}(a,!0===o.source?{}:o.source));var p,v,y,d=o.source||{};function h(t){if(!e.disabled&&!e.readOnly){var i=d.close,l=o.tab,a=function(e){return e.toLowerCase()}(t.key||String.fromCharCode(k)),s=t.keyCode,f=t.ctrlKey,p="enter"===a||13===s;t.shiftKey;var v=c.$(),y=v.after,h=v.before,g=v.end;v.start;var m=v.value,E=h.slice(-1),$=y.slice(0,1),C=h.match(u("(?:^|\\n)("+n(l)+"+).*$","")),K=C?C[1]:"",w=i[a];if(d.push&&d.push.call(c,t))c.push(l),b(),r(t);else if(d.pull&&d.pull.call(c,t))c.pull(l),b(),r(t);else if(f)"z"===a||90===s?(c.undo(),b(),r(t)):"y"!==a&&89!==s||(c.redo(),b(),r(t));else if("\\"!==E&&a===$)c.select(g+1),b(),r(t);else if("\\"!==E&&w)b(),c.wrap(a,w),b(),r(t);else if("backspace"===a||8===s){var O="",T="";for(var j in i)O+=j,T+=i[j];O="(["+n(O)+"])",T="(["+n(T)+"])";var L=h.match(u(O+"\\n(?:"+n(K)+")$","")),x=y.match(u("^\\n(?:"+n(K)+")"+T,""));!m&&L&&x&&x[1]===i[L[1]]?(c.trim("",""),b(),r(t)):!m&&h.match(u(n(l)+"$",""))?(c.pull(l),b(),r(t)):(w=i[E])&&w===$&&"\\"!==h.slice(-2,-1)&&(c.peel(E,$),r(t)),b()}else"delete"===a||46===s?((w=i[E])&&w===$&&(c.peel(E,$),r(t)),b()):p?((w=i[E])&&w===$?(c.wrap("\n"+l+K,"\n"+K).blur().focus(),r(t)):(m||K)&&(c.insert("\n",-1,!0).push(K).blur().focus(),r(t)),b()):setTimeout(b,0)}}function b(){f&&c.record()}return l&&(p="keydown",v=h,void 0===y&&(y=!1),e.addEventListener(p,v,y),b()),c.pop=function(){return function(e){return"function"==typeof e}(s)&&s.call(c),function(e,r,t){r.removeEventListener(e,t)}("keydown",e,h),f&&c.loss(!0),c},c.state=o,c}for(var a in l.prototype=function(e){return Object.create(e)}(i.prototype),l.prototype.constructor=l,i)l[a]=i[a];TE=l}}();