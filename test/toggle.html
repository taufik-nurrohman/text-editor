<!DOCTYPE html>
<html dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
    <title>Toggle &middot; Text Editor</title>
    <link href="test.css" rel="stylesheet">
    <script src="../text-editor.js"></script>
    <script src="../text-editor.toggle.js"></script>
  </head>
  <body>
    <h1>Toggle Test</h1>
    <p><textarea id="area">abcdef</textarea></p>
    <p>
      <button onclick="return toggle_A(), false;">toggle by selection state</button>
      <button onclick="return toggle_B(), false;">default toggle</button>
    </p>
    <script>
    var editor = new TE(document.getElementById('area'));
    function toggle_A() {
        editor.toggle(function(selection) {
            var h = /^<\/(?:p|h([0-6]))>/.exec(selection.after);
            this.peel(/<(?:p|h[0-6])>/, /<\/(?:p|h[0-6])>/);
            if (!h) {
                this.wrap('<p>', '</p>');
            } else {
                h = h[1] || 0;
                ++h;
                if (h > 6) {
                    this.wrap('<p>', '</p>');
                } else {
                    this.wrap('<h' + h + '>', '</h' + h + '>');
                }
            }
        });
    }
    function toggle_B() {
        editor.toggle(function() {
            this.peel(/(?:\s*<.*?>\s*)*/, /(?:\s*<\/.*?>\s*)*/).wrap('<code>', '</code>');
        }, function() {
            this.peel(/(?:\s*<.*?>\s*)*/, /(?:\s*<\/.*?>\s*)*/).wrap('<pre>\n  <code>', '</code>\n</pre>');
        }, function() {
            this.peel(/(?:\s*<.*?>\s*)*/, /(?:\s*<\/.*?>\s*)*/);
        });
    }
    </script>
  </body>
</html>